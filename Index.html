<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advocate Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-size: 16px;
            background-color: #1a1a1a;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding-bottom: 60px;
            color: #d4c9b8;
            transition: background-color 0.3s;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        .slide-up {
            animation: slideUp 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .hover-scale {
            transition: transform 0.3s ease-in-out;
        }
        .hover-scale:hover {
            transform: scale(1.05);
        }
        .click-pulse {
            animation: clickPulse 0.4s ease-in-out;
        }
        @keyframes clickPulse {
            0% { transform: scale(1); box-shadow: 0 0 0 rgba(0, 255, 255, 0); }
            50% { transform: scale(1.2); box-shadow: 0 0 15px #0ff; }
            100% { transform: scale(1); box-shadow: 0 0 0 rgba(0, 255, 255, 0); }
        }
        .card {
            background: #2a2a2a;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            border-left: 4px solid #007bff;
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        .card:hover {
            background: #333;
        }
        .category-card, .act-card {
            display: flex;
            align-items: center;
            gap: 10px;
            background: #2a2a2a;
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: transform 0.3s ease-in-out;
            flex-wrap: wrap;
        }
        .category-card:hover, .act-card:hover {
            transform: scale(1.02);
        }
        .category-icon, .act-icon {
            width: 24px;
            height: 24px;
            background-color: #60a5fa;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            flex-shrink: 0;
        }
        .details-section, .act-details, .category-details {
            display: none;
            background: #2a2a2a;
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        .button {
            background: #007bff;
            color: #fff;
            padding: 5px 10px;
            border-radius: 5px;
            text-decoration: none;
            margin-right: 10px;
        }
        .button-red {
            background: #dc3545;
        }
        input[type="date"], input[type="time"] {
            color: #d4c9b8;
            background: #1a1a1a;
            border: 1px solid #444;
        }
        input[type="date"]::-webkit-datetime-edit,
        input[type="time"]::-webkit-datetime-edit,
        input[type="date"]::-webkit-inner-spin-button,
        input[type="time"]::-webkit-inner-spin-button,
        input[type="date"]::-webkit-clear-button,
        input[type="time"]::-webkit-clear-button {
            color: #d4c9b8;
        }
        input[type="date"]:focus, input[type="time"]:focus {
            color: #d4c9b8;
            outline: none;
            border-color: #007bff;
        }
        nav {
            position: fixed;
            bottom: 0;
            width: 100%;
            background: #075e54;
            z-index: 20;
            display: flex;
            justify-content: space-around;
            padding: 8px 0;
        }
        header {
            background: #075e54;
            box-shadow: 0 1px 5px rgba(0,0,0,0.3);
            color: #fff;
        }
        .premium-icon {
    transition: transform 0.3s ease-in-out, filter 0.3s ease-in-out;
            width: 1.5em;
            height: 1.5em;
            fill: currentColor;
            transition: transform 0.4s ease-in-out, box-shadow 0.4s ease-in-out;
        }
        .premium-icon:hover {
            filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.7));
            transform: scale(1.1);
        }
        .tab-button {
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: transform 0.4s ease-in-out, box-shadow 0.4s ease-in-out;
        }
        .tab-button.active {
            background-color: #007bff;
            color: white;
        }
        .case-item {
            flex-wrap: wrap;
            gap: 10px;
        }
        .case-item div {
            flex: 1;
            min-width: 0;
        }
        .status-active {
            white-space: nowrap;
            padding: 2px 8px;
            background-color: #28a745;
            color: white;
            border-radius: 12px;
        }
        .case-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin-bottom: 10px;
        }
        .case-details div {
            background: #2a2a2a;
            padding: 8px;
            border-radius: 5px;
        }
        .category-card span, .category-card a {
            flex: 1;
            min-width: 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <meta name="theme-color" content="#075e54">
</head>
<body class="min-h-screen flex flex-col" id="body">
    <!-- Header -->
    <header class="bg-green-700 text-white p-4 flex items-center shadow-md fade-in">
        <i class="fas fa-user-tie premium-icon"></i>
        <h1 class="text-2xl font-bold">Advocate Assistant</h1>
    </header>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto p-4">
        <!-- Home Page: Law Categories and Popular Acts -->
        <div id="homePage" class="bg-gray-800 p-6 rounded-lg shadow-md slide-up">
            <h2 class="text-xl font-semibold mb-4 flex items-center">
                <i class="fas fa-gavel premium-icon"></i>
                Law Categories
            </h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 mb-6">
                <div class="category-card transition-all duration-300 ease-in-out hover:shadow-lg hover:bg-gray-700" onclick="showCategoryDetails('Constitution')">
                    <div class="category-icon"><i class="fas fa-book-open"></i></div>
                    <span>Constitution</span>
                    <button onclick="sendMessage(`Act as a legal expert. Provide a comprehensive explanation of the Constitution of India. Include its origin, structure (parts, articles, schedules), key features such as fundamental rights, directive principles, and federalism. Also, mention its significance and notable amendments.`); showPage('assistantPage'); animateIcon(this);" class="ml-auto text-green-400 underline hover:text-green-300 transition-transform duration-300">Ask AI</button>
                </div>
                <div class="category-card transition-all duration-300 ease-in-out hover:shadow-lg hover:bg-gray-700" onclick="showCategoryDetails('Bharatiya Nyaya Sanhita')">
                    <div class="category-icon"><i class="fas fa-balance-scale"></i></div>
                    <span>Bharatiya Nyaya Sanhita</span>
                    <button onclick="sendMessage(`Explain Bharatiya Nyaya Sanhita (BNS) in detail as a modern criminal code proposed to replace the Indian Penal Code (IPC). Include its structure, key differences from IPC, major sections, objectives like ensuring justice, and victim-oriented approach.`); showPage('assistantPage'); animateIcon(this);" class="ml-auto text-green-400 underline hover:text-green-300 transition-transform duration-300">Ask AI</button>
                </div>
                <div class="category-card transition-all duration-300 ease-in-out hover:shadow-lg hover:bg-gray-700" onclick="showCategoryDetails('Criminal Law')">
                    <div class="category-icon"><i class="fas fa-gavel"></i></div>
                    <span>Criminal Law</span>
                    <button onclick="sendMessage(`Act as a legal analyst. Describe in detail what Criminal Law in India entails. Include acts like IPC, CrPC, and the Evidence Act. Define how crimes are classified, procedures for trials, common punishments, and its role in public safety. Provide examples.`); showPage('assistantPage'); animateIcon(this);" class="ml-auto text-green-400 underline hover:text-green-300 transition-transform duration-300">Ask AI</button>
                </div>
                <div class="category-card transition-all duration-300 ease-in-out hover:shadow-lg hover:bg-gray-700" onclick="showCategoryDetails('Civil Law')">
                    <div class="category-icon"><i class="fas fa-scale-balanced"></i></div>
                    <span>Civil Law</span>
                    <button onclick="sendMessage(`Provide a detailed overview of Civil Law in India, including its scope, governing laws such as the CPC, and areas it covers like contracts, torts, property, and family disputes. Explain its process, burden of proof, and remedies available.`); showPage('assistantPage'); animateIcon(this);" class="ml-auto text-green-400 underline hover:text-green-300 transition-transform duration-300">Ask AI</button>
                </div>
                <div class="category-card transition-all duration-300 ease-in-out hover:shadow-lg hover:bg-gray-700" onclick="showCategoryDetails('Corporate Law')">
                    <div class="category-icon"><i class="fas fa-building"></i></div>
                    <span>Corporate Law</span>
                    <button onclick="sendMessage(`Give a professional breakdown of Corporate Law in India. Include details about the Companies Act 2013, company formation, regulatory bodies like MCA, and topics like mergers, acquisitions, and compliance. Use legal terminology.`); showPage('assistantPage'); animateIcon(this);" class="ml-auto text-green-400 underline hover:text-green-300 transition-transform duration-300">Ask AI</button>
                </div>
                <div class="category-card transition-all duration-300 ease-in-out hover:shadow-lg hover:bg-gray-700" onclick="showCategoryDetails('Property Law')">
                    <div class="category-icon"><i class="fas fa-home"></i></div>
                    <span>Property Law</span>
                    <button onclick="sendMessage(`Act as a legal advisor. Explain Property Law in India. Cover the Transfer of Property Act, types of property (movable/immovable), modes of transfer, inheritance laws, and typical legal disputes.`); showPage('assistantPage'); animateIcon(this);" class="ml-auto text-green-400 underline hover:text-green-300 transition-transform duration-300">Ask AI</button>
                </div>
                <div class="category-card transition-all duration-300 ease-in-out hover:shadow-lg hover:bg-gray-700" onclick="showCategoryDetails('Labour Law')">
                    <div class="category-icon"><i class="fas fa-briefcase"></i></div>
                    <span>Labour Law</span>
                    <button onclick="sendMessage(`Explain Labour Law in India with proper legal reference. Mention acts like the Factories Act, Minimum Wages Act, and Labour Code reforms. Describe worker rights, wage regulations, and industrial dispute resolution.`); showPage('assistantPage'); animateIcon(this);" class="ml-auto text-green-400 underline hover:text-green-300 transition-transform duration-300">Ask AI</button>
                </div>
                <div class="category-card transition-all duration-300 ease-in-out hover:shadow-lg hover:bg-gray-700" onclick="showCategoryDetails('Taxation')">
                    <div class="category-icon"><i class="fas fa-receipt"></i></div>
                    <span>Taxation</span>
                    <button onclick="sendMessage(`Provide a complete guide to Indian Taxation Laws. Mention Income Tax Act, 1961 and GST Act, 2017. Differentiate between direct and indirect taxes, and explain filing procedures, penalties, and exemptions.`); showPage('assistantPage'); animateIcon(this);" class="ml-auto text-green-400 underline hover:text-green-300 transition-transform duration-300">Ask AI</button>
                </div>
                <div class="category-card transition-all duration-300 ease-in-out hover:shadow-lg hover:bg-gray-700" onclick="showCategoryDetails('Environmental')">
                    <div class="category-icon"><i class="fas fa-leaf"></i></div>
                    <span>Environmental</span>
                    <button onclick="sendMessage(`Explain Environmental Law in India. Include acts like the Environment Protection Act, 1986 and Air &amp; Water Acts. Mention pollution control boards, penalties, NGT’s role, and conservation strategies.`); showPage('assistantPage'); animateIcon(this);" class="ml-auto text-green-400 underline hover:text-green-300 transition-transform duration-300">Ask AI</button>
                </div>
                <div class="category-card transition-all duration-300 ease-in-out hover:shadow-lg hover:bg-gray-700" onclick="showCategoryDetails('Family Law')">
                    <div class="category-icon"><i class="fas fa-users"></i></div>
                    <span>Family Law</span>
                    <button onclick="sendMessage(`Act as a legal educator. Provide a complete overview of Family Law in India. Include Hindu and Muslim personal laws, topics like marriage, divorce, adoption, guardianship, and inheritance with references to relevant acts.`); showPage('assistantPage'); animateIcon(this);" class="ml-auto text-green-400 underline hover:text-green-300 transition-transform duration-300">Ask AI</button>
                </div>
            </div>
            <div id="Constitution-info" class="category-details mt-2"></div><div id="Bharatiya Nyaya Sanhita-info" class="category-details mt-2"></div><div id="Criminal Law-info" class="category-details mt-2"></div><div id="Civil Law-info" class="category-details mt-2"></div><div id="Corporate Law-info" class="category-details mt-2"></div><div id="Property Law-info" class="category-details mt-2"></div><div id="Labour Law-info" class="category-details mt-2"></div><div id="Taxation-info" class="category-details mt-2"></div><div id="Environmental-info" class="category-details mt-2"></div><div id="Family Law-info" class="category-details mt-2"></div>
            <h2 class="text-xl font-semibold mb-4 flex items-center">
                <i class="fas fa-book premium-icon"></i>
                Popular Acts
            </h2>
            <div id="popularActs" class="space-y-4">
                <div class="act-card transition-all duration-300 ease-in-out hover:shadow-lg hover:bg-gray-700" onclick="toggleActDetails('BNS')">
                    <div class="act-icon"><i class="fas fa-balance-scale"></i></div>
                    <span>Bharatiya Nyaya Sanhita (BNS)</span>
                    <span class="ml-auto text-gray-400">View sections and clauses</span>
                </div>
                <div class="act-details" id="BNS-details">
                    <h3>Sections and Clauses</h3>
                    <ul>
                        <li>Section 101: General Explanation</li>
                        <li>Section 102: Punishment</li>
                    </ul>
                </div>
                <div class="act-card transition-all duration-300 ease-in-out hover:shadow-lg hover:bg-gray-700" onclick="toggleActDetails('BNSS')">
                    <div class="act-icon"><i class="fas fa-shield-alt"></i></div>
                    <span>Bharatiya Nagarik Suraksha Sanhita (BNSS)</span>
                    <span class="ml-auto text-gray-400">View sections and clauses</span>
                </div>
                <div class="act-details" id="BNSS-details">
                    <h3>Sections and Clauses</h3>
                    <ul>
                        <li>Section 201: Arrest</li>
                        <li>Section 202: Bail</li>
                    </ul>
                </div>
                <div class="act-card transition-all duration-300 ease-in-out hover:shadow-lg hover:bg-gray-700" onclick="toggleActDetails('BSA')">
                    <div class="act-icon"><i class="fas fa-gavel"></i></div>
                    <span>Bharatiya Sakshya Adhiniyam (BSA)</span>
                    <span class="ml-auto text-gray-400">View sections and clauses</span>
                </div>
                <div class="act-details" id="BSA-details">
                    <h3>Sections and Clauses</h3>
                    <ul>
                        <li>Section 301: Evidence</li>
                        <li>Section 302: Witnesses</li>
                    </ul>
                </div>
                <div class="act-card transition-all duration-300 ease-in-out hover:shadow-lg hover:bg-gray-700" onclick="toggleActDetails('Constitution')">
                    <div class="act-icon"><i class="fas fa-book-open"></i></div>
                    <span>Constitution of India</span>
                    <span class="ml-auto text-gray-400">View sections and clauses</span>
                </div>
                <div class="act-details" id="Constitution-details">
                    <h3>Sections and Clauses</h3>
                    <ul>
                        <li>Article 21: Right to Life</li>
                        <li>Article 32: Remedies</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Case History Page -->
        <div id="caseHistoryPage" class="bg-gray-800 p-6 rounded-lg shadow-md slide-up hidden">
            <h2 class="text-xl font-semibold mb-4 flex items-center">
                <i class="fas fa-history premium-icon"></i>
                Case History
            </h2>
            <div class="mb-4 flex space-x-4">
                <button class="tab-button" onclick="filterCases('active')">Active Cases</button>
                <button class="tab-button" onclick="filterCases('closed')">Closed Cases</button>
                <button class="tab-button" onclick="filterCases('all')">All Cases</button>
            </div>
            <div id="caseList" class="space-y-4"></div>
        </div>

        <!-- Case Details Page -->
        <div id="caseDetailsPage" class="hidden bg-gray-800 p-6 rounded-lg shadow-md slide-up">
            <h2 class="text-xl font-semibold mb-4 flex items-center">
                <i class="fas fa-info-circle premium-icon"></i>
                Case Details
            </h2>
            <div id="caseDetailsContent" class="space-y-4"></div>
            <div class="details-section" id="caseDetailsExtra">
                <h3 class="text-lg font-medium">Details</h3>
                <p><strong>Created on:</strong> <span id="createdOn"></span></p>
                <p><strong>Last updated:</strong> <span id="lastUpdated"></span></p>
            </div>
            <div class="hearings-section" id="hearingsSection">
                <h3 class="text-lg font-medium">Hearings</h3>
                <p id="noHearings">No hearings recorded yet. Add one to track the progress of the case.</p>
                <div id="hearingList" class="space-y-2"></div>
                <button onclick="addHearing()" class="button mt-2">+ Add Hearing</button>
            </div>
            <div class="mt-4 flex space-x-2">
                <a href="#" onclick="editCaseFromDetails()" class="button hover-scale">
                    <i class="fas fa-edit premium-icon"></i>
                    Edit
                </a>
                <a href="#" onclick="deleteCaseFromDetails()" class="button button-red hover-scale">
                    <i class="fas fa-trash-alt premium-icon"></i>
                    Delete
                </a>
                <button onclick="showPage('caseHistoryPage')" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 hover-scale flex items-center">
                    <i class="fas fa-arrow-left premium-icon"></i>
                    Back
                </a>
            </div>
        </div>

        <!-- Workbook Section -->
        <div id="workbookPage" class="hidden bg-gray-800 p-6 rounded-lg shadow-md slide-up">
            <h2 class="text-xl font-semibold mb-4 flex items-center">
                <i class="fas fa-book premium-icon"></i>
                Case Workbook
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="label-above">Case Title</label>
                    <input id="caseTitle" type="text" placeholder="Case Title" class="border p-2 rounded w-full bg-gray-700 text-white">
                </div>
                <div>
                    <label class="label-above">Case Number</label>
                    <input id="caseNumber" type="text" placeholder="Case Number" class="border p-2 rounded w-full bg-gray-700 text-white">
                </div>
                <div>
                    <label class="label-above">Court</label>
                    <input id="court" type="type" placeholder="Court" class="border p-2 rounded w-full bg-gray-700 text-white">
                </div>
                <div>
                    <label class="label-above">Client Name</label>
                    <input id="clientName" type="text" placeholder="Client Name" class="border p-2 rounded w-full bg-gray-700 text-white">
                </div>
                <div>
                    <label class="label-above">Case Date</label>
                    <input id="caseDate" type="date" class="border p-2 rounded w-full bg-gray-700 text-white" onfocus="this.placeholder=''" onblur="this.placeholder='Case Date'">
                </div>
                <div>
                    <label class="label-above">Status</label>
                    <select id="caseStatus" class="border p-2 rounded w-full bg-gray-700 text-white">
                        <option value="Pending">Pending</option>
                        <option value="In Progress">In Progress</option>
                        <option value="Closed">Closed</option>
                    </select>
                </div>
                <div>
                    <label class="label-above">Next Hearing Date</label>
                    <input id="nextHearing" type="date" class="border p-2 rounded w-full bg-gray-700 text-white" onfocus="this.placeholder=''" onblur="this.placeholder='Next Hearing Date'">
                </div>
                <div>
                    <label class="label-above">Hearing Time</label>
                    <input id="hearingTime" type="time" class="border p-2 rounded w-full bg-gray-700 text-white" onfocus="this.placeholder=''" onblur="this.placeholder='Hearing Time'">
                </div>
                <div class="md:col-span-2">
                    <label class="label-above">Case Description</label>
                    <textarea id="caseDescription" placeholder="Case Description" class="border p-2 rounded w-full h-24 bg-gray-700 text-white"></textarea>
                </div>
                <div class="md:col-span-2">
                    <label class="label-above">Documents</label>
                    <input id="caseDocuments" type="file" multiple class="border p-2 rounded w-full bg-gray-700 text-white">
                </div>
            </div>
            <button onclick="addCase()" class="bg-green-700 text-white px-4 py-2 rounded hover:bg-green-800 hover-scale flex items-center">
                <i class="fas fa-plus premium-icon"></i>
                Add Case
            </button>
        </div>

        <!-- AI Case Assistant Section -->
        <div id="assistantPage" class="hidden bg-gray-800 p-6 rounded-lg shadow-md slide-up">
            <h2 class="text-xl font-semibold mb-4 flex items-center">
                <i class="fas fa-robot premium-icon"></i>
                AI Case Assistant
            </h2>
            <div class="chat-container flex flex-col" id="chatBox"></div>
            <div class="input-area mt-4 flex">
                <textarea id="chatInput" placeholder="Type your message or case details..." class="border p-2 rounded w-full resize-none focus:outline-none focus:ring-2 focus:ring-green-500 bg-gray-700 text-white" rows="2"></textarea>
                <button onclick="sendMessage()" class="bg-green-700 text-white px-4 py-2 rounded hover:bg-green-800 hover:scale-105 ml-2 flex items-center">
                    <i class="fas fa-paper-plane premium-icon"></i>
                    Send
                </button>
            </div>
            <div class="old-chats mt-4">
                <h3 class="text-md font-semibold mb-2">Old Chats</h3>
                <div id="oldChatsList"></div>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settingsPage" class="hidden bg-gray-800 p-6 rounded-lg shadow-md slide-up">
            <h2 class="text-xl font-semibold mb-4 flex items-center">
                <i class="fas fa-cog premium-icon"></i>
                Settings
            </h2>
            <div class="space-y-4">
                <div>
                    <label class="block mb-2">Language:</label>
                    <select id="language" class="border p-2 rounded w-full bg-gray-700 text-white" onchange="changeLanguage()">
                        <option value="en">English</option>
                        <option value="hi">हिन्दी</option>
                    </select>
                </div>
                <div>
                    <label class="block mb-2">Theme:</label>
                    <select id="theme" class="border p-2 rounded w-full bg-gray-700 text-white" onchange="changeTheme()">
                        <option value="gray">Gray</option>
                        <option value="white">White</option>
                        <option value="red">Red</option>
                        <option value="blue">Blue</option>
                        <option value="orange">Orange</option>
                        <option value="sky">Sky Blue</option>
                        <option value="black">Black</option>
                        <option value="green">Green</option>
                    </select>
                </div>
                <div>
                    <label class="block mb-2">Text Size:</label>
                    <input id="textSize" type="range" min="12" max="20" value="16" class="w-full bg-gray-700" onchange="changeTextSize()">
                </div>
                <div>
                    <button onclick="downloadBackup()" class="bg-green-700 text-white px-4 py-2 rounded hover:bg-green-800 hover-scale flex items-center">
                        <i class="fas fa-download premium-icon"></i>
                        Download Backup
                    </button>
                    <input id="backupFile" type="file" accept=".json" class="hidden" onchange="restoreBackup()">
                    <button onclick="document.getElementById('backupFile').click()" class="bg-green-700 text-white px-4 py-2 rounded hover:bg-green-800 hover-scale mt-2 flex items-center">
                        <i class="fas fa-upload premium-icon"></i>
                        Restore Backup
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Bottom Navigation -->
    <nav class="bg-green-700 text-white p-4 flex justify-around items-center fixed bottom-0 w-full shadow-md">
        <button onclick="showPage('homePage')" class="flex flex-col items-center hover:bg-green-800 p-2 rounded hover-scale flex-1 mx-1">
            <i class="fas fa-home premium-icon"></i>
            <span class="text-sm">Home</span>
        </button>
        <button onclick="showPage('caseHistoryPage')" class="flex flex-col items-center hover:bg-green-800 p-2 rounded hover-scale flex-1 mx-1">
            <i class="fas fa-history premium-icon"></i>
            <span class="text-sm">Cases</span>
        </button>
        <button onclick="showPage('workbookPage')" class="flex flex-col items-center hover:bg-green-800 p-2 rounded hover-scale flex-1 mx-1">
            <i class="fas fa-book-open premium-icon"></i>
            <span class="text-sm">Workbook</span>
        </button>
        <button onclick="showPage('assistantPage')" class="flex flex-col items-center hover:bg-green-800 p-2 rounded hover-scale flex-1 mx-1">
            <i class="fas fa-robot premium-icon"></i>
            <span class="text-sm">AI Assistant</span>
        </button>
        <button onclick="showPage('settingsPage')" class="flex flex-col items-center hover:bg-green-800 p-2 rounded hover-scale flex-1 mx-1">
            <i class="fas fa-sliders-h premium-icon"></i>
            <span class="text-sm">Settings</span>
        </button>
    </nav>

    <script>
        let cases = JSON.parse(localStorage.getItem('cases')) || [];
        let currentCaseId = null;
        let currentLanguage = 'en';
        let chatHistory = JSON.parse(localStorage.getItem('chatHistory')) || [];
        let currentChatId = null;
        let currentFilter = 'all';
        let hearings = JSON.parse(localStorage.getItem('hearings')) || {};

        const GEMINI_API_KEY = "AIzaSyC151MOHgFcc-xUuXPCV860AfhgA9EyN5o";

        function showPage(pageId) {
            const pages = ['homePage', 'caseHistoryPage', 'caseDetailsPage', 'workbookPage', 'assistantPage', 'settingsPage'];
            pages.forEach(p => document.getElementById(p).classList.add('hidden'));
            document.getElementById(pageId).classList.remove('hidden');
            document.getElementById(pageId).classList.add('slide-up');
            setTimeout(() => document.getElementById(pageId).classList.remove('slide-up'), 500);
            if (pageId === 'assistantPage') {
                displayChatHistory();
                displayOldChats();
            }
            if (pageId === 'caseHistoryPage') {
                filterCases(currentFilter);
                checkHearingReminders();
            }
            animateIcon(document.querySelector(`button[onclick="showPage('${pageId}')"]`));
        }

        function showCategoryDetails(category) {
            
    // Hide all category info blocks first
    document.querySelectorAll('.category-details').forEach(el => el.style.display = 'none');
    let details = document.getElementById(category + '-info');
    let content = '';
    switch(category) {
                case 'Constitution':
                    content = `
                        <h3>Constitution of India</h3>
                        <p>The Constitution of India is the supreme law of India, enacted on January 26, 1950. It lays down the framework defining fundamental political principles, establishes the structure, procedures, powers, and duties of government institutions, and sets out fundamental rights, directive principles, and the duties of citizens.</p>
                        <ul>
                            <li><strong>Articles:</strong> 395 articles in 22 parts.</li>
                            <li><strong>Amendments:</strong> Over 100 amendments since inception.</li>
                            <li><strong>Key Features:</strong> Federal structure, parliamentary democracy, fundamental rights.</li>
                        </ul>
                    `;
                    break;
                case 'Bharatiya Nyaya Sanhita':
                    content = `
                        <h3>Bharatiya Nyaya Sanhita</h3>
                        <p>Bharatiya Nyaya Sanhita (BNS) is a proposed criminal code to replace the Indian Penal Code (IPC). It aims to modernize and simplify criminal laws in India with a focus on justice delivery.</p>
                        <ul>
                            <li><strong>Sections:</strong> Over 350 sections.</li>
                            <li><strong>Objective:</strong> Ensure speedy justice and address contemporary crimes.</li>
                            <li><strong>Key Change:</strong> Emphasis on victim rights.</li>
                        </ul>
                    `;
                    break;
                case 'Criminal Law':
                    content = `
                        <h3>Criminal Law</h3>
                        <p>Criminal Law in India deals with offenses against the state or society, governed by the Indian Penal Code (IPC) and the Code of Criminal Procedure (CrPC).</p>
                        <ul>
                            <li><strong>Key Acts:</strong> IPC, CrPC, Evidence Act.</li>
                            <li><strong>Offenses:</strong> Murder, theft, assault, etc.</li>
                            <li><strong>Punishments:</strong> Imprisonment, fines, or death penalty.</li>
                        </ul>
                    `;
                    break;
                case 'Civil Law':
                    content = `
                        <h3>Civil Law</h3>
                        <p>Civil Law deals with disputes between individuals or organizations, governed by the Code of Civil Procedure (CPC) and various personal laws.</p>
                        <ul>
                            <li><strong>Key Areas:</strong> Property disputes, contracts, family law.</li>
                            <li><strong>Objective:</strong> Provide remedies like damages or injunctions.</li>
                            <li><strong>Procedure:</strong> Lengthy court process.</li>
                        </ul>
                    `;
                    break;
                case 'Corporate Law':
                    content = `
                        <h3>Corporate Law</h3>
                        <p>Corporate Law regulates the formation, operation, and dissolution of companies, primarily under the Companies Act, 2013.</p>
                        <ul>
                            <li><strong>Key Act:</strong> Companies Act, 2013.</li>
                            <li><strong>Focus:</strong> Corporate governance, mergers, acquisitions.</li>
                            <li><strong>Regulator:</strong> Ministry of Corporate Affairs.</li>
                        </ul>
                    `;
                    break;
                case 'Property Law':
                    content = `
                        <h3>Property Law</h3>
                        <p>Property Law governs the ownership, transfer, and use of land and other assets, regulated by the Transfer of Property Act, 1882.</p>
                        <ul>
                            <li><strong>Key Act:</strong> Transfer of Property Act, 1882.</li>
                            <li><strong>Types:</strong> Movable and immovable property.</li>
                            <li><strong>Disputes:</strong> Ownership, inheritance.</li>
                        </ul>
                    `;
                    break;
                case 'Labour Law':
                    content = `
                        <h3>Labour Law</h3>
                        <p>Labour Law protects the rights of workers and regulates employer-employee relationships, governed by acts like the Factories Act and Minimum Wages Act.</p>
                        <ul>
                            <li><strong>Key Acts:</strong> Factories Act, 1948; Minimum Wages Act, 1948.</li>
                            <li><strong>Focus:</strong> Wages, working conditions, disputes.</li>
                            <li><strong>Authority:</strong> Labour Courts.</li>
                        </ul>
                    `;
                    break;
                case 'Taxation':
                    content = `
                        <h3>Taxation</h3>
                        <p>Taxation Law deals with the levy and collection of taxes, governed by the Income Tax Act, 1961, and GST Act.</p>
                        <ul>
                            <li><strong>Key Acts:</strong> Income Tax Act, 1961; GST Act, 2017.</li>
                            <li><strong>Types:</strong> Direct and indirect taxes.</li>
                            <li><strong>Authority:</strong> Income Tax Department.</li>
                        </ul>
                    `;
                    break;
                case 'Environmental':
                    content = `
                        <h3>Environmental Law</h3>
                        <p>Environmental Law protects the environment, enforced through acts like the Environment Protection Act, 1986.</p>
                        <ul>
                            <li><strong>Key Act:</strong> Environment Protection Act, 1986.</li>
                            <li><strong>Focus:</strong> Pollution control, conservation.</li>
                            <li><strong>Authority:</strong> National Green Tribunal.</li>
                        </ul>
                    `;
                    break;
                case 'Family Law':
                    content = `
                        <h3>Family Law</h3>
                        <p>Family Law governs marriage, divorce, and inheritance, based on personal laws like Hindu Marriage Act and Muslim Personal Law.</p>
                        <ul>
                            <li><strong>Key Acts:</strong> Hindu Marriage Act, 1955; Muslim Personal Law.</li>
                            <li><strong>Focus:</strong> Marriage, divorce, custody.</li>
                            <li><strong>Disputes:</strong> Alimony, property division.</li>
                        </ul>
                    `;
                    break;
            }
            details.innerHTML = content;
            details.style.display = 'block';
            animateIcon(document.querySelector(`.category-card[onclick="showCategoryDetails('${category}')"]`));
        }

        function toggleActDetails(actId) {
            const details = document.getElementById(`${actId}-details`);
            details.style.display = details.style.display === 'block' ? 'none' : 'block';
            animateIcon(document.querySelector(`.act-card[onclick="toggleActDetails('${actId}')"]`));
        }

        function addCase() {
            const caseTitle = document.getElementById('caseTitle').value;
            const caseNumber = document.getElementById('caseNumber').value;
            const court = document.getElementById('court').value;
            const clientName = document.getElementById('clientName').value;
            const caseDate = document.getElementById('caseDate').value;
            const caseStatus = document.getElementById('caseStatus').value;
            const nextHearing = document.getElementById('nextHearing').value;
            const hearingTime = document.getElementById('hearingTime').value;
            const caseDescription = document.getElementById('caseDescription').value;
            const caseDocuments = document.getElementById('caseDocuments').files;

            if (caseTitle && caseNumber && court && clientName && caseDate) {
                const caseData = {
                    id: Date.now(),
                    caseTitle,
                    caseNumber,
                    court,
                    clientName,
                    caseDate,
                    caseStatus,
                    nextHearing,
                    hearingTime,
                    caseDescription,
                    documents: Array.from(caseDocuments).map(file => file.name),
                    createdOn: new Date().toLocaleDateString(),
                    lastUpdated: new Date().toLocaleDateString()
                };
                cases.push(caseData);
                localStorage.setItem('cases', JSON.stringify(cases));
                displayCases();
                clearForm();
                showPage('caseHistoryPage');
                checkHearingReminders();
            } else {
                alert(currentLanguage === 'hi' ? 'कृपया सभी आवश्यक क्षेत्रों को भरें।' : 'Please fill in all required fields.');
            }
        }

        function filterCases(filter) {
            currentFilter = filter;
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.tab-button[onclick="filterCases('${filter}')"]`).classList.add('active');
            animateIcon(document.querySelector(`.tab-button[onclick="filterCases('${filter}')"]`));
            let filteredCases = [];
            if (filter === 'active') {
                filteredCases = cases.filter(c => c.caseStatus === 'Pending' || c.caseStatus === 'In Progress');
            } else if (filter === 'closed') {
                filteredCases = cases.filter(c => c.caseStatus === 'Closed');
            } else {
                filteredCases = [...cases];
            }
            displayCases(filteredCases);
        }

        function displayCases(filteredCases = cases) {
            const caseList = document.getElementById('caseList');
            caseList.innerHTML = '';
            if (filteredCases.length === 0) {
                caseList.innerHTML = `<p class="text-gray-400">${currentLanguage === 'hi' ? 'कोई मामले नहीं मिले।' : 'No cases found.'}</p>`;
                return;
            }
            filteredCases.forEach(c => {
                const caseDiv = document.createElement('div');
                caseDiv.className = 'card case-item';
                caseDiv.innerHTML = `
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center w-full">
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-medium truncate">${c.caseTitle}</h3>
                            <p class="text-sm truncate">Case No: ${c.caseNumber}</p>
                            <p class="text-sm truncate">Client: ${c.clientName}</p>
                            <p class="text-sm truncate">Court: ${c.court}</p>
                        </div>
                        <span class="status-active mt-2 md:mt-0">${c.caseStatus}</span>
                    </div>
                    <p class="text-sm text-gray-400 mt-2">Upcoming: ${c.nextHearing ? new Date(c.nextHearing + ' ' + (c.hearingTime || '00:00')).toLocaleString() : 'N/A'}</p>
                `;
                caseDiv.onclick = () => showCaseDetails(c.id);
                caseList.appendChild(caseDiv);
            });
        }

        function showCaseDetails(id) {
            const caseData = cases.find(c => c.id === id);
            if (caseData) {
                currentCaseId = id;
                const caseDetailsContent = document.getElementById('caseDetailsContent');
                caseDetailsContent.innerHTML = `
                    <div class="card">
                        <div class="flex justify-between items-center mb-2">
                            <h3 class="text-lg font-medium">${caseData.caseTitle}</h3>
                            <span class="status-active">${caseData.caseStatus}</span>
                        </div>
                        <div class="case-details">
                            <div><strong>Case No:</strong> ${caseData.caseNumber}</div>
                            <div><strong>Court:</strong> ${caseData.court}</div>
                            <div><strong>Client:</strong> ${caseData.clientName}</div>
                            <div><strong>Hearing:</strong> ${caseData.nextHearing ? new Date(caseData.nextHearing + ' ' + (caseData.hearingTime || '00:00')).toLocaleString() : 'N/A'}</div>
                            <div><strong>Description:</strong> ${caseData.caseDescription || 'N/A'}</div>
                        </div>
                    </div>
                `;
                document.getElementById('createdOn').textContent = caseData.createdOn;
                document.getElementById('lastUpdated').textContent = caseData.lastUpdated;
                displayHearings(id);
                showPage('caseDetailsPage');
            }
        }

        function editCaseFromDetails() {
            const caseData = cases.find(c => c.id === currentCaseId);
            if (caseData) {
                document.getElementById('caseTitle').value = caseData.caseTitle;
                document.getElementById('caseNumber').value = caseData.caseNumber;
                document.getElementById('court').value = caseData.court;
                document.getElementById('clientName').value = caseData.clientName;
                document.getElementById('caseDate').value = caseData.caseDate;
                document.getElementById('caseStatus').value = caseData.caseStatus;
                document.getElementById('nextHearing').value = caseData.nextHearing;
                document.getElementById('hearingTime').value = caseData.hearingTime;
                document.getElementById('caseDescription').value = caseData.caseDescription;
                deleteCase(currentCaseId);
                showPage('workbookPage');
            }
        }

        function deleteCaseFromDetails() {
            if (confirm(currentLanguage === 'hi' ? 'क्या आप इस मामले को हटाना चाहते हैं?' : 'Are you sure you want to delete this case?')) {
                deleteCase(currentCaseId);
                delete hearings[currentCaseId];
                localStorage.setItem('hearings', JSON.stringify(hearings));
                showPage('caseHistoryPage');
            }
        }

        function deleteCase(id) {
            cases = cases.filter(c => c.id !== id);
            localStorage.setItem('cases', JSON.stringify(cases));
            displayCases();
            checkHearingReminders();
        }

        function clearForm() {
            document.getElementById('caseTitle').value = '';
            document.getElementById('caseNumber').value = '';
            document.getElementById('court').value = '';
            document.getElementById('clientName').value = '';
            document.getElementById('caseDate').value = '';
            document.getElementById('caseStatus').value = 'Pending';
            document.getElementById('nextHearing').value = '';
            document.getElementById('hearingTime').value = '';
            document.getElementById('caseDescription').value = '';
            document.getElementById('caseDocuments').value = '';
        }

        function addHearing() {
            const hearingDate = prompt(currentLanguage === 'hi' ? 'सुनवाई की तारीख दर्ज करें (YYYY-MM-DD HH:MM):' : 'Enter hearing date (YYYY-MM-DD HH:MM):');
            if (hearingDate) {
                if (!hearings[currentCaseId]) hearings[currentCaseId] = [];
                hearings[currentCaseId].push({ date: hearingDate, createdOn: new Date().toLocaleString() });
                localStorage.setItem('hearings', JSON.stringify(hearings));
                displayHearings(currentCaseId);
            }
        }

        function displayHearings(caseId) {
            const hearingList = document.getElementById('hearingList');
            const noHearings = document.getElementById('noHearings');
            hearingList.innerHTML = '';
            if (hearings[caseId] && hearings[caseId].length > 0) {
                noHearings.style.display = 'none';
                hearings[caseId].forEach((hearing, index) => {
                    const hearingDiv = document.createElement('div');
                    hearingDiv.className = 'card';
                    hearingDiv.innerHTML = `
                        <p>Upcoming: ${new Date(hearing.date).toLocaleString()}</p>
                        <p>Created on: ${hearing.createdOn}</p>
                        <button onclick="deleteHearing(${caseId}, ${index})" class="button button-red mt-2">Delete</button>
                    `;
                    hearingList.appendChild(hearingDiv);
                });
            } else {
                noHearings.style.display = 'block';
            }
        }

        function deleteHearing(caseId, index) {
            if (confirm(currentLanguage === 'hi' ? 'क्या आप इस सुनवाई को हटाना चाहते हैं?' : 'Are you sure you want to delete this hearing?')) {
                hearings[caseId].splice(index, 1);
                if (hearings[caseId].length === 0) delete hearings[caseId];
                localStorage.setItem('hearings', JSON.stringify(hearings));
                displayHearings(caseId);
            }
        }

        async function sendMessage(message, isCase = false) {
            const chatInput = document.getElementById('chatInput');
            const chatBox = document.getElementById('chatBox');
            if (message || chatInput.value.trim()) {
                const userMessage = message || chatInput.value.trim();
                if (!currentChatId) {
                    currentChatId = Date.now();
                    chatHistory.push({ id: currentChatId, messages: [] });
                }
                const currentChat = chatHistory.find(chat => chat.id === currentChatId);
                currentChat.messages.push({ role: 'user', content: userMessage, timestamp: new Date().toISOString() });
                chatBox.innerHTML += `<div class="chat-message user-message fade-in">${userMessage}</div>`;
                chatInput.value = '';
                chatBox.scrollTop = chatBox.scrollHeight;
                localStorage.setItem('chatHistory', JSON.stringify(chatHistory));

                try {
                    const context = currentChat.messages.map(m => `${m.role === 'user' ? 'User' : 'AI'}: ${m.content}`).join('\n');
                    let prompt = isCase 
                        ? `आप एक कानूनी सहायक AI हैं जिसके पास localStorage में 'cases' कुंजी के तहत संग्रहीत मामला डेटा तक पूर्ण पहुँच है। डेटा संरचना में id, caseTitle, caseNumber, court, clientName, caseDate, caseStatus, nextHearing, hearingTime, caseDescription, documents, createdOn, और lastUpdated शामिल हैं। वर्तमान मामले: ${JSON.stringify(cases)}\nइनपुट: ${userMessage}\nआपका कार्य:\n1. शामिल प्रमुख कानूनी मुद्दों की पहचान करें।\n2. प्रासंगिक तथ्यों को तोड़ें।\n3. लागू कानून या अधिनियमों का उल्लेख करें (भारतीय संदर्भ, जैसे IPC, CPC, CrPC, संविधान)।\n4. कानूनी उपाय या कार्रवाइयों का सुझाव दें।\n5. यदि उपयोगकर्ता मामले को संपादित या हटाने का अनुरोध करता है, तो localStorage में 'cases' सरणी पर कार्रवाई करें और प्रदर्शन को अपडेट करें।\n6. स्पष्टीकरण के लिए कोई अनुवर्ती प्रश्न पूछें यदि आवश्यक हो।\nस्पष्ट, पेशेवर स्वर में जवाब दें, जैसे कि आप एक वकील को संक्षेप में बता रहे हों।\nप्रारूप:\n- **मुख्य मुद्दे:**\n- **प्रासंगिक तथ्य:**\n- **लागू कानून:**\n- **संभावित उपाय:**\n- **कार्रवाई की गई (यदि कोई):** \n- **सुझाव/अतिरिक्त प्रश्न:**\nसंदर्भ: ${context}`
                        : `Google द्वारा बनाया गया Gemini 2.0 Flash की तरह व्यवहार करें, बातचीत के तरीके से जवाब दें और यदि लागू हो तो मामले को हल करने में सहायता करें: ${userMessage}\nसंदर्भ: ${context}`;
                    const response = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=' + GEMINI_API_KEY, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{
                                    text: prompt
                                }]
                            }],
                            generationConfig: {
                                maxOutputTokens: 500,
                                temperature: 0.7
                            }
                        })
                    });
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}, message: ${await response.text()}`);
                    }
                    const data = await response.json();
                    if (data.candidates && data.candidates[0].content && data.candidates[0].content.parts) {
                        let aiResponseText = data.candidates[0].content.parts[0].text.replace(/\n/g, '<br>');
                        if (currentLanguage === 'hi') {
                            aiResponseText = translateToHindi(aiResponseText);
                        }
                        const editMatch = aiResponseText.match(/Edit case ID (\d+) with (.*)/i);
                        const deleteMatch = aiResponseText.match(/Delete case ID (\d+)/i);
                        if (editMatch) {
                            const caseId = parseInt(editMatch[1]);
                            const updates = JSON.parse(editMatch[2].replace(/'/g, '"'));
                            const caseIndex = cases.findIndex(c => c.id === caseId);
                            if (caseIndex !== -1) {
                                cases[caseIndex] = { ...cases[caseIndex], ...updates, lastUpdated: new Date().toLocaleDateString() };
                                localStorage.setItem('cases', JSON.stringify(cases));
                                displayCases();
                                aiResponseText += '<br>Case updated successfully.';
                            }
                        } else if (deleteMatch) {
                            const caseId = parseInt(deleteMatch[1]);
                            deleteCase(caseId);
                            aiResponseText += '<br>Case deleted successfully.';
                        }
                        currentChat.messages.push({ role: 'ai', content: aiResponseText, timestamp: new Date().toISOString() });
                        chatBox.innerHTML += `<div class="chat-message ai-message fade-in">${aiResponseText}</div>`;
                        localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
                    } else {
                        chatBox.innerHTML += `<div class="chat-message ai-message fade-in">${currentLanguage === 'hi' ? 'त्रुटि: AI से कोई प्रतिक्रिया नहीं।' : 'Error: No response from AI.'}</div>`;
                    }
                } catch (error) {
                    chatBox.innerHTML += `<div class="chat-message ai-message fade-in">${currentLanguage === 'hi' ? 'त्रुटि: ' + error.message : 'Error: ' + error.message}</div>`;
                }
                chatBox.scrollTop = chatBox.scrollHeight;
            }
        }

        function displayChatHistory() {
            const chatBox = document.getElementById('chatBox');
            chatBox.innerHTML = '';
            const currentChat = chatHistory.find(chat => chat.id === currentChatId) || { messages: [] };
            currentChat.messages.forEach(msg => {
                chatBox.innerHTML += `<div class="chat-message ${msg.role === 'user' ? 'user-message' : 'ai-message'} fade-in">${msg.content}</div>`;
            });
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        function displayOldChats() {
            const oldChatsList = document.getElementById('oldChatsList');
            oldChatsList.innerHTML = '';
            chatHistory.forEach(chat => {
                const lastMessage = chat.messages[chat.messages.length - 1]?.content || 'No messages';
                const chatItem = document.createElement('div');
                chatItem.className = 'old-chat-item';
                chatItem.innerHTML = `<span>${lastMessage.substring(0, 30)}${lastMessage.length > 30 ? '...' : ''}</span> <span class="text-xs text-gray-500">${new Date(chat.messages[chat.messages.length - 1]?.timestamp || chat.id).toLocaleString()}</span>`;
                chatItem.onclick = () => restartChat(chat.id);
                oldChatsList.appendChild(chatItem);
            });
        }

        function restartChat(chatId) {
            currentChatId = chatId;
            displayChatHistory();
        }

        function translateToHindi(text) {
            const translations = {
                'Analyze': 'विश्लेषण करें',
                'Case': 'मामला',
                'Details': 'विवरण',
                'Client': 'क्लाइंट',
                'Date': 'दिनांक',
                'Status': 'स्थिति',
                'Next Hearing': 'अगली सुनवाई',
                'Description': 'विवरण',
                'Documents': 'दस्तावेज',
                'Error': 'त्रुटि',
                'No response from AI': 'AI से कोई प्रतिक्रिया नहीं',
                'Please provide case details': 'कृपया मामला विवरण प्रदान करें',
                'Please upload a document to scan': 'कृपया दस्तावेज़ अपलोड करें',
                'Indian law': 'भारतीय कानून',
                'suggest': 'सुझाव दें',
                'relevant': 'प्रासंगिक',
                'laws': 'कानून',
                'acts': 'अधिनियम',
                'sections': 'खंड',
                'actions': 'कार्रवाइयाँ',
                'under': 'के अंतर्गत',
                'Respond': 'प्रतिक्रिया करें',
                'conversationally': 'संवादात्मक रूप से',
                'assist': 'सहायता करें',
                'with': 'के साथ',
                'case-solving': 'मामला हल करना',
                'Hello': 'नमस्ते',
                'How': 'कैसे',
                'can': 'सकता',
                'I': 'मैं',
                'help': 'मदद',
                'you': 'आप',
                'today': 'आज',
                'Section': 'धारा',
                'Act': 'कानून',
                'Law': 'कानून',
                'Key Issues': 'मुख्य मुद्दे',
                'Relevant Facts': 'प्रासंगिक तथ्य',
                'Applicable Laws': 'प्रासंगिक कानून',
                'Possible Remedies': 'संभावित उपाय',
                'Suggestions/Further Questions': 'सुझाव/अतिरिक्त प्रश्न',
                'Title': 'शीर्षक',
                'Number': 'नंबर',
                'Court': 'कोर्ट',
                'Case Date': 'मामला तिथि',
                'Created on': 'बनाया गया',
                'Last updated': 'अंतिम अपडेट',
                'Hearings': 'सुनवाइयाँ',
                'No hearings recorded yet. Add one to track the progress of the case.': 'अभी तक कोई सुनवाई दर्ज नहीं की गई। प्रगति को ट्रैक करने के लिए एक जोड़ें।',
                'Hearing Time': 'सुनवाई का समय',
                'Next Hearing Date': 'अगली सुनवाई की तारीख',
                'Case updated successfully': 'मामला सफलतापूर्वक अपडेट किया गया',
                'Case deleted successfully': 'मामला सफलतापूर्वक हटाया गया'
            };
            return text.split(' ').map(word => {
                const lowerWord = word.toLowerCase();
                return translations[lowerWord] || translations[word] || word;
            }).join(' ');
        }

        function changeLanguage() {
            currentLanguage = document.getElementById('language').value;
            if (currentLanguage === 'hi') {
                document.querySelector('h1').textContent = 'वकील सहायक';
                document.querySelector('#homePage h2:nth-child(1)').textContent = 'कानून श्रेणियाँ';
                document.querySelector('#homePage h2:nth-child(3)').textContent = 'लोकप्रिय अधिनियम';
                document.querySelector('#caseHistoryPage h2').textContent = 'मामला इतिहास';
                document.querySelector('#caseDetailsPage h2').textContent = 'मामला विवरण';
                document.querySelector('#workbookPage h2').textContent = 'मामला कार्यपुस्तिका';
                document.querySelector('#assistantPage h2').textContent = 'एआई केस सहायक';
                document.querySelector('#settingsPage h2').textContent = 'सेटिंग्स';
                document.querySelectorAll('.label-above')[0].textContent = 'मामले का शीर्षक';
                document.querySelectorAll('.label-above')[1].textContent = 'मामले का नंबर';
                document.querySelectorAll('.label-above')[2].textContent = 'कोर्ट';
                document.querySelectorAll('.label-above')[3].textContent = 'क्लाइंट का नाम';
                document.querySelectorAll('.label-above')[4].textContent = 'मामला तिथि';
                document.querySelectorAll('.label-above')[5].textContent = 'स्थिति';
                document.querySelectorAll('.label-above')[6].textContent = 'अगली सुनवाई की तारीख';
                document.querySelectorAll('.label-above')[7].textContent = 'सुनवाई का समय';
                document.querySelectorAll('.label-above')[8].textContent = 'विवरण';
                document.querySelectorAll('.label-above')[9].textContent = 'दस्तावेज';
                document.getElementById('chatInput').placeholder = 'अपना संदेश या मामला विवरण टाइप करें...';
                document.querySelectorAll('nav button span')[0].textContent = 'होम';
                document.querySelectorAll('nav button span')[1].textContent = 'मामले';
                document.querySelectorAll('nav button span')[2].textContent = 'कार्यपुस्तिका';
                document.querySelectorAll('nav button span')[3].textContent = 'एआई सहायक';
                document.querySelectorAll('nav button span')[4].textContent = 'सेटिंग्स';
                document.getElementById('noHearings').textContent = translateToHindi('No hearings recorded yet. Add one to track the progress of the case.');
            } else {
                document.querySelector('h1').textContent = 'Advocate Assistant';
                document.querySelector('#homePage h2:nth-child(1)').textContent = 'Law Categories';
                document.querySelector('#homePage h2:nth-child(3)').textContent = 'Popular Acts';
                document.querySelector('#caseHistoryPage h2').textContent = 'Case History';
                document.querySelector('#caseDetailsPage h2').textContent = 'Case Details';
                document.querySelector('#workbookPage h2').textContent = 'Case Workbook';
                document.querySelector('#assistantPage h2').textContent = 'AI Case Assistant';
                document.querySelector('#settingsPage h2').textContent = 'Settings';
                document.querySelectorAll('.label-above')[0].textContent = 'Case Title';
                document.querySelectorAll('.label-above')[1].textContent = 'Case Number';
                document.querySelectorAll('.label-above')[2].textContent = 'Court';
                document.querySelectorAll('.label-above')[3].textContent = 'Client Name';
                document.querySelectorAll('.label-above')[4].textContent = 'Case Date';
                document.querySelectorAll('.label-above')[5].textContent = 'Status';
                document.querySelectorAll('.label-above')[6].textContent = 'Next Hearing Date';
                document.querySelectorAll('.label-above')[7].textContent = 'Hearing Time';
                document.querySelectorAll('.label-above')[8].textContent = 'Case Description';
                document.querySelectorAll('.label-above')[9].textContent = 'Documents';
                document.getElementById('chatInput').placeholder = 'Type your message or case details...';
                document.querySelectorAll('nav button span')[0].textContent = 'Home';
                document.querySelectorAll('nav button span')[1].textContent = 'Cases';
                document.querySelectorAll('nav button span')[2].textContent = 'Workbook';
                document.querySelectorAll('nav button span')[3].textContent = 'AI Assistant';
                document.querySelectorAll('nav button span')[4].textContent = 'Settings';
                document.getElementById('noHearings').textContent = 'No hearings recorded yet. Add one to track the progress of the case.';
            }
            displayCases();
            if (currentCaseId) {
                showCaseDetails(currentCaseId);
            }
        }

        function changeTheme() {
            const theme = document.getElementById('theme').value;
            const body = document.getElementById('body');
            const textColor = theme === 'black' ? '#fff' : '#d4c9b8';
            body.style.backgroundColor = theme === 'white' ? '#ffffff' :
                theme === 'red' ? '#ff0000' :
                theme === 'blue' ? '#0000ff' :
                theme === 'orange' ? '#ffa500' :
                theme === 'sky' ? '#87ceeb' :
                theme === 'black' ? '#000000' :
                theme === 'green' ? '#008000' : '#1a1a1a';
            body.style.color = textColor;
            document.querySelectorAll('input, textarea, select').forEach(element => {
                element.style.color = textColor;
                element.style.backgroundColor = theme === 'white' ? '#fff' : '#2a2a2a';
                element.style.borderColor = '#444';
            });
            document.querySelectorAll('input[type="date"], input[type="time"]').forEach(element => {
                element.style.color = textColor;
                element.style.caretColor = textColor;
            });
        }

        function changeTextSize() {
            const size = document.getElementById('textSize').value + 'px';
            document.body.style.fontSize = size;
        }

        function downloadBackup() {
            const dataStr = 'data:text/json;charset=utf-8,' + encodeURIComponent(JSON.stringify({ cases, chatHistory, hearings }));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute('href', dataStr);
            downloadAnchorNode.setAttribute('download', 'backup_' + new Date().toLocaleString() + '.json');
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            document.body.removeChild(downloadAnchorNode);
        }

        function restoreBackup() {
            const file = document.getElementById('backupFile').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const data = JSON.parse(e.target.result);
                    cases = data.cases || [];
                    chatHistory = data.chatHistory || [];
                    hearings = data.hearings || {};
                    localStorage.setItem('cases', JSON.stringify(cases));
                    localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
                    localStorage.setItem('hearings', JSON.stringify(hearings));
                    displayCases();
                    displayOldChats();
                    if (currentChatId) displayChatHistory();
                    alert(currentLanguage === 'hi' ? 'बैकअप सफलतापूर्वक पुनर्स्थापित किया गया।' : 'Backup restored successfully.');
                };
                reader.readAsText(file);
            }
        }

        function checkHearingReminders() {
            if ('Notification' in window && Notification.permission === 'granted') {
                const now = new Date();
                cases.forEach(caseItem => {
                    if (caseItem.nextHearing && caseItem.hearingTime) {
                        const hearingDateTime = new Date(caseItem.nextHearing + ' ' + caseItem.hearingTime);
                        const timeDiff = (hearingDateTime - now) / (1000 * 60);
                        if (timeDiff > 0 && timeDiff <= 30) {
                            new Notification(`Hearing Reminder`, {
                                body: `Case: ${caseItem.caseTitle}\nHearing at: ${hearingDateTime.toLocaleString()}`,
                                icon: '/icon-192x192.png'
                            });
                        }
                    }
                });
            } else if (Notification.permission !== 'denied') {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        checkHearingReminders();
                    }
                });
            }
        }

        function animateIcon(button) {
            const icon = button.querySelector('.premium-icon');
            if (icon) {
                icon.classList.add('click-pulse');
                setTimeout(() => icon.classList.remove('click-pulse'), 400);
            }
        }

        document.querySelectorAll('button').forEach(button => {
            button.addEventListener('click', function(e) {
                const icon = this.querySelector('.premium-icon');
                if (icon) {
                    icon.classList.add('click-pulse');
                    setTimeout(() => icon.classList.remove('click-pulse'), 400);
                }
            });
        });

        displayCases();
        showPage('homePage');
        
            }
    </script>
</body>
</html>
